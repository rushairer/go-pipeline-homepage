---
sidebar_position: 1
---

# Go Pipeline v2 ä»‹ç»

Go Pipeline v2 æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„Goè¯­è¨€æ‰¹å¤„ç†ç®¡é“æ¡†æ¶ï¼Œæ”¯æŒæ³›å‹ã€å¹¶å‘å®‰å…¨ï¼Œæä¾›æ ‡å‡†æ‰¹å¤„ç†å’Œå»é‡æ‰¹å¤„ç†ä¸¤ç§æ¨¡å¼ã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

- **æ³›å‹æ”¯æŒ**: åŸºäºGo 1.18+æ³›å‹ï¼Œç±»å‹å®‰å…¨
- **æ‰¹å¤„ç†æœºåˆ¶**: æ”¯æŒæŒ‰å¤§å°å’Œæ—¶é—´é—´éš”è‡ªåŠ¨æ‰¹å¤„ç†
- **å¹¶å‘å®‰å…¨**: å†…ç½®goroutineå®‰å…¨æœºåˆ¶
- **çµæ´»é…ç½®**: å¯è‡ªå®šä¹‰ç¼“å†²åŒºå¤§å°ã€æ‰¹å¤„ç†å¤§å°å’Œåˆ·æ–°é—´éš”
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œä¼ æ’­æœºåˆ¶
- **ä¸¤ç§æ¨¡å¼**: æ ‡å‡†æ‰¹å¤„ç†å’Œå»é‡æ‰¹å¤„ç†
- **åŒæ­¥/å¼‚æ­¥**: æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥æ‰§è¡Œæ¨¡å¼
- **éµå¾ªGoæƒ¯ä¾‹**: é‡‡ç”¨"è°å†™è°å…³é—­"çš„é€šé“ç®¡ç†åŸåˆ™

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Go 1.18+ (æ”¯æŒæ³›å‹)
- æ”¯æŒ Linuxã€macOSã€Windows

## ğŸ“¦ å®‰è£…

```bash
go get github.com/rushairer/go-pipeline/v2@latest
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Data Input    â”‚â”€â”€â”€â–¶â”‚   Buffer Channel â”‚â”€â”€â”€â–¶â”‚  Batch Processorâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚                        â”‚
                                â–¼                        â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚   Timer Ticker   â”‚    â”‚   Flush Handler â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚                        â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚  Error Channel  â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ æ ¸å¿ƒç»„ä»¶

### æ¥å£å®šä¹‰

- **`PipelineChannel[T]`**: å®šä¹‰ç®¡é“é€šé“è®¿é—®æ¥å£
- **`Performer`**: å®šä¹‰æ‰§è¡Œç®¡é“æ“ä½œçš„æ¥å£
- **`DataProcessor[T]`**: å®šä¹‰æ‰¹å¤„ç†æ•°æ®çš„æ ¸å¿ƒæ¥å£
- **`Pipeline[T]`**: ç»„åˆæ‰€æœ‰ç®¡é“åŠŸèƒ½çš„é€šç”¨æ¥å£

### å®ç°ç±»å‹

- **`StandardPipeline[T]`**: æ ‡å‡†æ‰¹å¤„ç†ç®¡é“ï¼Œæ•°æ®æŒ‰é¡ºåºæ‰¹å¤„ç†
- **`DeduplicationPipeline[T]`**: å»é‡æ‰¹å¤„ç†ç®¡é“ï¼ŒåŸºäºå”¯ä¸€é”®å»é‡
- **`PipelineImpl[T]`**: é€šç”¨ç®¡é“å®ç°ï¼Œæä¾›åŸºç¡€åŠŸèƒ½

## ğŸ’¡ å¿«é€Ÿå¼€å§‹

### æ ‡å‡†ç®¡é“ç¤ºä¾‹

```go
package main

import (
    "context"
    "fmt"
    "log"
    "time"
    
    gopipeline "github.com/rushairer/go-pipeline/v2"
)

func main() {
    // åˆ›å»ºæ ‡å‡†ç®¡é“
    pipeline := gopipeline.NewDefaultStandardPipeline(
        func(ctx context.Context, batchData []int) error {
            fmt.Printf("å¤„ç†æ‰¹æ¬¡æ•°æ®: %v\n", batchData)
            return nil
        },
    )
    
    ctx, cancel := context.WithTimeout(context.Background(), time.Second*10)
    defer cancel()
    
    // å¯åŠ¨å¼‚æ­¥å¤„ç†
    go func() {
        if err := pipeline.AsyncPerform(ctx); err != nil {
            log.Printf("ç®¡é“æ‰§è¡Œé”™è¯¯: %v", err)
        }
    }()
    
    // ç›‘å¬é”™è¯¯
    errorChan := pipeline.ErrorChan(10)
    go func() {
        for err := range errorChan {
            log.Printf("å¤„ç†é”™è¯¯: %v", err)
        }
    }()
    
    // æ·»åŠ æ•°æ®
    dataChan := pipeline.DataChan()
    for i := 0; i < 100; i++ {
        dataChan <- i
    }
    
    // å…³é—­æ•°æ®é€šé“
    close(dataChan)
    
    // ç­‰å¾…å¤„ç†å®Œæˆ
    time.Sleep(time.Second * 2)
}
```

## ğŸ“‹ é…ç½®å‚æ•°

```go
type PipelineConfig struct {
    BufferSize    uint32        // ç¼“å†²é€šé“çš„å®¹é‡ (é»˜è®¤: 100)
    FlushSize     uint32        // æ‰¹å¤„ç†æ•°æ®çš„æœ€å¤§å®¹é‡ (é»˜è®¤: 50)
    FlushInterval time.Duration // å®šæ—¶åˆ·æ–°çš„æ—¶é—´é—´éš” (é»˜è®¤: 50ms)
}
```

### ğŸ¯ æ€§èƒ½ä¼˜åŒ–çš„é»˜è®¤å€¼

åŸºäºæ€§èƒ½åŸºå‡†æµ‹è¯•ï¼Œv2 ç‰ˆæœ¬é‡‡ç”¨äº†ä¼˜åŒ–çš„é»˜è®¤é…ç½®ï¼š

- **BufferSize: 100** - ç¼“å†²åŒºå¤§å°ï¼Œåº”è¯¥ >= FlushSize * 2 ä»¥é¿å…é˜»å¡
- **FlushSize: 50** - æ‰¹å¤„ç†å¤§å°ï¼Œæ€§èƒ½æµ‹è¯•æ˜¾ç¤º 50 å·¦å³ä¸ºæœ€ä¼˜
- **FlushInterval: 50ms** - åˆ·æ–°é—´éš”ï¼Œå¹³è¡¡å»¶è¿Ÿå’Œååé‡

## ä¸‹ä¸€æ­¥

- [æ ‡å‡†ç®¡é“](./standard-pipeline) - äº†è§£æ ‡å‡†æ‰¹å¤„ç†ç®¡é“çš„ä½¿ç”¨
- [å»é‡ç®¡é“](./deduplication-pipeline) - äº†è§£å»é‡æ‰¹å¤„ç†ç®¡é“çš„ä½¿ç”¨
- [é…ç½®æŒ‡å—](./configuration) - è¯¦ç»†çš„é…ç½®å‚æ•°è¯´æ˜
- [API å‚è€ƒ](./api-reference) - å®Œæ•´çš„APIæ–‡æ¡£